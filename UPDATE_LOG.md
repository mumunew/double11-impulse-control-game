# 游戏功能更新日志

## 最新版本 - 三关游戏模式

### 关卡设置
1. **第一关**
   - 目标分数：300分
   - 完成后弹窗警告下一关内容

2. **第二关**
   - 目标分数：1000分
   - 冲动消费扣分更多
   - 理性消费得分更多
   - 念头速度加快一倍
   - 完成后弹窗警告下一关会出现促销信息

3. **第三关**
   - 目标分数：3000分
   - 念头速度进一步加快
   - 部分理性和消费念头带有促销字样
   - 带有促销字样的念头得失分加倍

## 更新内容

### 1. 关卡升级弹窗功能
- 添加了精美的关卡升级弹窗，当玩家完成当前关卡时自动显示
- 弹窗显示新关卡信息、新目标分数和鼓励信息
- 根据不同关卡显示不同的提示信息
- 玩家需要点击"继续挑战"按钮才能进入下一关

### 2. 射掉理性消费加倍扣分
- 从第二关开始，射理性消费的扣分从-20分增加到-40分
- 如果理性消费带有促销字样，扣分进一步加倍到-80分
- 添加了相应的音效和视觉反馈

### 3. 关卡速度增加
- 每通过一关，消费念头的下落速度增加0.6个单位（之前是0.4）
- 玩家移动速度也会随着关卡增加而提高，保持游戏平衡
- 关卡间隔时间减少，增加游戏难度

### 4. 第三关后出现促销字样
- 从第三关开始，40%的消费念头会带有"促销"字样
- 带有促销字样的冲动消费得分加倍（40分）
- 带有促销字样的理性消费扣分加倍（80分）
- 添加了特殊的视觉效果：金色边框、闪烁效果和"×2"标记

## 技术实现细节

1. **关卡升级弹窗**：
   - 添加了新的HTML结构和CSS样式
   - 创建了`showLevelUpPopup()`函数来显示弹窗
   - 添加了继续按钮的事件监听器

2. **加倍扣分机制**：
   - 修改了`checkBulletCollision()`函数
   - 根据关卡和是否为促销消费计算扣分

3. **速度增加系统**：
   - 修改了`spawnThought()`函数中的速度计算公式
   - 在`startGame()`函数中增加了玩家速度随关卡提升的逻辑

4. **促销消费功能**：
   - 在消费念头对象中添加了`isPromotion`属性
   - 修改了`draw()`函数，为促销消费添加特殊视觉效果
   - 更新了分数计算逻辑，实现促销消费的分数加倍效果

## 游戏体验优化

- 增加了更多的视觉反馈和动画效果
- 优化了游戏难度曲线，使游戏更具挑战性和趣味性
- 添加了更多的游戏提示和指导信息
- 增强了游戏的成就感和奖励机制
